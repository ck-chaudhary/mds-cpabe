First version that appears to be working.
